<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style/calculator.css" />
    <title>Квиз по кухне</title>
  </head>
  <body>
    <!-- Секция калькулятора/квиза: основной контейнер для всего квиза -->
    <section class="calculator" id="calculator">
      <div class="container calculator__container">
        <!-- Заголовок квиза -->
        <h2 class="calculator__title">Рассчитайте стоимость кухни</h2>
        <!-- Подзаголовок, объясняющий цель квиза -->
        <p class="calculator__subtitle">
          Ответьте на несколько вопросов и узнайте предварительную стоимость
          вашей будущей кухни
        </p>

        <!-- Основной блок вопросов квиза, инициализированный Alpine.js -->
        <div class="questions questions__container" x-data="quiz()">
          <!-- Блок с вопросами -->
          <div x-show="!showResults">
            <div class="questions__question-wrapper">
              <div class="questions__question-title">
                <span x-text="questions[currentQuestionIndex].question"></span>
              </div>
              <!-- === НОВЫЙ БЛОК ДЛЯ ИЗОБРАЖЕНИЯ ВОПРОСА === -->
              <!-- === АЛЬТЕРНАТИВНЫЙ ВАРИАНТ С x-if === -->
              <template x-if="questions[currentQuestionIndex].image">
                <div class="question-image-container">
                  <img
                    :src="questions[currentQuestionIndex].image"
                    alt="Поясняющее изображение"
                  />
                </div>
              </template>

              <!-- Контейнер для ответов -->

              <!-- Разметка для RADIO -->
              <template x-if="questions[currentQuestionIndex].type === 'radio'">
                <div
                  class="questions__answer-images"
                  :class="questions[currentQuestionIndex].customClass"
                >
                  <template
                    x-for="answer in questions[currentQuestionIndex].answers"
                    :key="answer.value"
                  >
                    <label
                      class="questions__answer-image"
                      :class="{ 'selected': questions[currentQuestionIndex].selectedAnswer === answer.value }"
                    >
                      <input
                        type="radio"
                        :name="'question-' + currentQuestionIndex"
                        :value="answer.value"
                        x-model="questions[currentQuestionIndex].selectedAnswer"
                        class="sr-only"
                      />
                      <img :src="answer.image" :alt="answer.text" />
                      <span x-text="answer.text"></span>
                    </label>
                  </template>
                </div>
              </template>

              <!-- Разметка для RANGE -->
              <template x-if="questions[currentQuestionIndex].type === 'range'">
                <div class="range-slider">
                  <input
                    type="range"
                    :min="questions[currentQuestionIndex].min"
                    :max="questions[currentQuestionIndex].max"
                    :step="questions[currentQuestionIndex].step"
                    x-model.number="questions[currentQuestionIndex].selectedAnswer"
                  />
                  <div class="range-value">
                    <span
                      x-text="questions[currentQuestionIndex].selectedAnswer"
                    ></span>
                    <span x-text="questions[currentQuestionIndex].unit"></span>
                  </div>
                </div>
              </template>
            </div>

            <!-- Навигационная панель -->
            <div class="questions__navbar">
              <div class="questions__navbar-progress">
                <div
                  class="questions__navbar-progress-bar"
                  :style="`width: ${progress}%`"
                ></div>
              </div>
              <div class="questions__navbar-buttons">
                <button
                  class="questions__navbar__prev-button"
                  @click="prevQuestion()"
                  :disabled="currentQuestionIndex === 0"
                >
                  Назад
                </button>
                <button
                  class="questions__navbar__next-button"
                  @click="nextQuestion()"
                  :disabled="!questions[currentQuestionIndex].selectedAnswer && questions[currentQuestionIndex].type === 'radio'"
                >
                  <span
                    x-text="currentQuestionIndex < questions.length - 1 ? 'Далее' : 'Результат'"
                  ></span>
                </button>
              </div>
            </div>
          </div>

          <!-- Экран результатов -->
          <div x-show="showResults">
            <h2>Результаты</h2>
            <ul>
              <template x-for="(question, index) in questions" :key="index">
                <li>
                  <span x-text="question.question"></span>:
                  <strong x-text="getAnswerText(question)"></strong>
                </li>
              </template>
            </ul>
            <button @click="restartQuiz()">Начать заново</button>
          </div>
        </div>
      </div>
    </section>
    <!-- Подключение Alpine.js (отложенная загрузка) -->
    <script defer src="js/alpine.min.js"></script>
    <!-- Подключение основного скрипта квиза -->
    <script src="js/calculator.js"></script>
  </body>
</html>
